<html>
<head>
  <title>第十四章 安装与更新软件包</title>
  <basefont face="Consolas" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/308816 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: Consolas;
      font-size: 11pt;
    }
  </style>
</head>
<body>
<a name="3836"/>

<div>
<span><div><div><div><div><div><div><div><div><span style="font-size: 12pt; color: rgb(0, 0, 255); font-weight: bold;">第十四章 安装与更新软件包</span></div><div><br/></div><div><span style="font-weight: bold;">目标：</span></div><ul><li><div>从红帽和yum软件包仓库下载、安装、更新和管理软件包。</div></li></ul><div><br/></div></div><div><span style="font-weight: bold;">章节：</span></div><ul><li><div>注册系统以获得红帽支持</div></li><li><div>解释与调查RPM软件包</div></li><li><div>使用yum安装与更新软件包</div></li><li><div>启用yum软件仓库</div></li><li><div>管理软件包模块流</div></li></ul><div><br/></div><div><br/></div><div><span style="font-weight: bold;">第一节：注册系统以获得红帽支持</span></div><div><span style="font-weight: bold;">目标：</span></div><ul><li><div>完成本节后，学生应该能将系统注册到红帽账户，并使用红帽订阅管理为其分配软件</div></li></ul><div>     更新和支持服务的权利。</div><div><br/></div></div><div><span style="font-weight: bold;">红帽订阅管理：Red Hat Subscription Management</span></div><ul><li><div>红帽订阅管理提供可用于向计算机授权产品订阅的工具，让管理员能够获取软件包的更新，</div></li></ul><div>     并且跟踪系统所用支持合同和订阅的相关信息。</div><ul><li><div>PackageKit和yum等标准工具可以通过红帽提供的内容分发网络获取软件包和更新。</div></li><li><div>红帽订阅管理工具可以执行下列四项基本任务：</div></li></ul><div>     1. 注册（Register）</div><div>     2. 订阅（Subscribe）</div><div>     3. 启动软件仓库（Enable repositories）</div><div>     4. 审核和跟踪（Review and track）</div><div><br/></div><div><span style="font-weight: bold;">注册系统：</span></div><ul><li><div>可通过图形界面和命令行方式将操作系统注册到Red Hat Customer Portal。</div></li><li><div>图形界面注册：</div></li></ul><div>     Activities -<span style="font-family: &quot;DejaVu Sans Mono&quot;;">&gt;</span> Type to search... -<span style="font-family: &quot;DejaVu Sans Mono&quot;;">&gt;</span> subscription -<span style="font-family: &quot;DejaVu Sans Mono&quot;;">&gt;</span> </div><div>     Red Hat Subscription Manager -<span style="font-family: &quot;DejaVu Sans Mono&quot;;">&gt;</span> 跟随指引完成注册</div><div>     <img src="chapter14_files/Image.png" type="image/png" data-filename="Image.png" width="497"/></div><div>     <img src="chapter14_files/Image [1].png" type="image/png" data-filename="Image.png" width="500"/>     </div><div><br/></div><div><span style="font-weight: bold;">从命令行注册：</span></div><ul><li><div>使用subscription-manager命令注册。</div></li></ul><div>     <img src="chapter14_files/Image [2].png" type="image/png" data-filename="Image.png" width="498"/></div><div><br/></div><div><span style="font-weight: bold;">授权证书：</span></div><ul><li><div>注册之后，/etc/pki目录中的授权证书存储了本地订阅授权信息。</div></li><li><div>/etc/pki/product中的证书指明系统上安装了哪些红帽产品。</div></li><li><div>/etc/pki/consumer中的证书指明系统所注册到的红帽账户。</div></li><li><div>/etc/pki/entitlement中的证书指明该系统附加有哪些订阅。</div></li><li><div>建议使用subscription-manager工具查看系统订阅信息。</div></li></ul><div><br/></div><div>     <span style="color: rgb(250, 122, 0); font-weight: bold;">练习 P480：</span><span style="color: rgb(250, 122, 0); font-weight: bold;">REGISTERING SYSTEMS FOR RED HAT SUPPORT</span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">第二节：解释与调查RPM软件包</span></div><div><span style="font-weight: bold;">目标：</span></div><ul><li><div>完成本节后，学生应该能说明如何以RPM软件包形式提供软件，并使用yum和RPM调查</div></li></ul><div>     系统上安装的软件包。</div><div><br/></div><div><span style="font-weight: bold;">软件包与RPM：</span></div><ul><li><div>RPM软件包管理器最先由红帽开发，该程序提供了一种标准的方式来打包软件进行分发</div></li></ul><div>     与使用，从归档提取到文件系统的软件（源代码安装）相比，采用RPM软件包形式管理</div><div>     软件要简单得多。</div><ul><li><div>管理员可以跟踪软件包所安装的文件。</div></li><li><div>已安装软件包的信息存储在本地RPM数据库中。</div></li><li><div><span style="font-weight: bold;">红帽的所有软件都以RPM形式提供。</span></div></li><li><div>RPM软件包文件名由四个元素组成：<span style="font-weight: bold;">name-version-release.architecture</span></div></li></ul><div>     <img src="chapter14_files/Image [3].png" type="image/png" data-filename="Image.png" width="440"/></div><div>     1. NAME：描述软件名</div><div>     2. VERSION：原始软件版本号</div><div>     3. RELEASE：基于该版本的软件包的发行版号，由软件打包商设置，不一定是原始软件开发商。</div><div>     4. ARCH：编译软件包的CPU处理器架构，noarch表示不限定架构。</div><div><br/></div><ul><li><div>基于yum安装软件包时，只需要软件包的名称。</div></li><li><div>如果存在多个版本，默认安装最高版本（latest）。</div></li></ul><div><br/></div><ul><li><div>每个RPM软件包包含3部分内容：</div></li></ul><div>     1. 安装的文件</div><div>     2. 元数据（metadata）：</div><div>        如name、version、release和arch；软件包的摘要和描述；依赖关系；授权许可信息；软件包更改日志。</div><div>     3. 安装、更新或删除软件包时可能运行的脚本。</div><div><br/></div><ul><li><div>RPM软件包验证原理：该过程类似Chrome Mailvelope邮件签名过程</div></li></ul><div>     1. 红帽使用相应的GPG私钥对RPM软件包进行数字签名（digitally sign）。</div><div>     2. 安装RPM软件包的主机的RPM系统使用GPG公钥（<span style="font-weight: bold;">/etc/pki/rpm-gpg/RPM-GPG-KEY-*</span>）解密由GPG私钥</div><div>        加密的签名，通过签名来验证软件包的完整性。</div><div>     3. 如果GPG数字签名不匹配，RPM系统拒绝安装软件包。</div></div><div><br/></div><div><span style="font-weight: bold;">通过RPM包更新软件：</span></div><ul><li><div>红帽默认安装最新版本软件，更新软件时，将先卸载旧版本，再安装新版本（通常保留配置文件）。</div></li><li><div>通常只能安装一个版本的软件包。</div></li><li><div>个别软件可以同时安装多个版本，如kernel。</div></li><li><div><span style="font-weight: bold;">若新版本kernel安装失败而无法引导系统时，可切换至旧版本kernel重新引导系统。</span></div></li></ul><div><br/></div><div><span style="font-weight: bold;">检查RPM软件包：</span></div><ul><li><div>rpm命令可以用于管理rpm软件包，也可以查询rpm软件包信息。</div></li><li><div>rpm命令默认从本地rpm数据库查询软件包信息，但 -p 选项可以指定未安装的rpm软件包。</div></li><li><div>常用rpm查询命令示例：</div></li></ul><div>     $ rpm -qa：查询所有已安装的rpm软件包</div><div>     $ rpm -qf &lt;<span style="font-style: italic;">filename</span>&gt;：查询指定文件所属的rpm软件包</div><div>     $ rpm -q &lt;<span style="font-style: italic;">package_name</span>&gt;：查看当前已安装的rpm软件包版本</div><div>     $ rpm -qi &lt;<span style="font-style: italic;">package_name</span>&gt;：查看当前已安装的rpm软件包详细信息</div><div>     $ rpm -ql &lt;<span style="font-style: italic;">package_name</span>&gt;：查看当前已安装的rpm软件包中的所有文件</div><div>     $ rpm -qc &lt;<span style="font-style: italic;">package_name</span>&gt;：查看当前已安装的rpm软件包中的配置文件</div><div>     $ rpm -qd &lt;<span style="font-style: italic;">package_name</span>&gt;：查看当前已安装的rpm软件包中的文档</div><div>     <span style="font-weight: bold;">$ rpm -q --changelog &lt;</span><span style="font-style: italic; font-weight: bold;">package_name</span><span style="font-weight: bold;">&gt;</span>：查看当前已安装的rpm软件包更改信息</div><div>     <span style="font-weight: bold;">$ rpm -q --scripts &lt;</span><span style="font-style: italic; font-weight: bold;">package_name</span><span style="font-weight: bold;">&gt;</span>：查看当前已安装的rpm软件包中安装、升级与卸载过程中运行的脚本</div><div>     <img src="chapter14_files/Image [4].png" type="image/png" data-filename="Image.png" width="497"/></div><div><br/></div><div>     <span style="font-weight: bold;">$ rpm -qpl &lt;</span><span style="font-style: italic; font-weight: bold;">uninstalled_package_name</span><span style="font-weight: bold;">&gt;.rpm</span>：查看未安装rpm软件包的所有文件</div><div>     <img src="chapter14_files/Image [5].png" type="image/png" data-filename="Image.png" width="498"/></div><div><br/></div><div><span style="font-weight: bold;">安装RPM软件包：</span></div><ul><li><div>$ rpm -ivh &lt;<span style="font-style: italic;">package_name</span>&gt;.rpm：安装rpm软件包</div></li></ul><div>     <img src="chapter14_files/Image [6].png" type="image/png" data-filename="Image.png" width="498"/></div><ul><li><div>更推荐使用yum方式管理RPM软件包的安装与更新</div></li></ul><div><br/></div><div>     <span style="color: rgb(0, 0, 255); font-weight: bold;">* 注意：</span></div><div>       1. 安装第三方软件包时，RPM软件包可能会含有在安装过程中以root用户运行任意脚本。</div><div>       2. 可以从RPM软件包中提取文件，而不安装此软件包。 </div><div>       3. <span style="font-weight: bold;">rpm2cpio程序可以将RPM的内容传递给cpio归档工具，后者可以提取所有文件或单个文件。</span></div><div>       4. rpm2cpio命令示例：</div><div>          <span style="font-weight: bold;">$ rpm2cpio &lt;</span><span style="font-style: italic; font-weight: bold;">package_name</span><span style="font-weight: bold;">&gt;.rpm | cpio -it</span>：查看未安装的rpm软件包中的文件</div><div>          <span style="font-weight: bold;">$ rpm2cpio </span><span style="font-weight: bold;">&lt;</span><span style="font-style: italic; font-weight: bold;">package_name</span><span style="font-weight: bold;">&gt;.rpm | cpio -id</span>：提取rpm软件包文件至当前工作目录中</div><div>          $ rpm2cpio &lt;<span style="font-style: italic;">package_name</span>&gt;.rpm | cpio -id &quot;*txt&quot;：提取rpm软件包中的指定文件</div><div>          <img src="chapter14_files/Image [7].png" type="image/png" data-filename="Image.png" width="535"/></div><div><br/></div><div><span style="font-weight: bold;">RPM查询命令摘要：</span></div><ul><li><div>-p选项：查询未安装的rpm软件包时使用</div></li><li><div>常用rpm相关命令：rpmspec、rpmbuild、<span style="font-weight: bold;">rpm2cpio</span>、<span style="font-weight: bold;">rpmdb</span>、rpmkeys、rpmsign。</div></li></ul><div>     <img src="chapter14_files/Image [8].png" type="image/png" data-filename="Image.png" width="498"/></div><div><br/></div><div>     <span style="color: rgb(250, 122, 0); font-weight: bold;">练习 P487：</span><span style="color: rgb(250, 122, 0); font-weight: bold;">EXPLAINING AND INVESTIGATING RPM SOFTWARE PACKAGES</span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">第三节：</span> <span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Consolas; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">使用yum安装与更新软件包</span></div><div><span style="font-weight: bold;">目标：</span></div><ul><li><div>完成本节后，学生应该能使用yum命令发现、更新与安装软件包。</div></li></ul><div><br/></div><div><span style="font-weight: bold;">使用yum管理软件包：</span></div><ul><li><div>rpm命令无法与软件仓库一起使用或解决依赖关系。</div></li><li><div>yum命令可以安装、更新、删除和获取有关软件包及其依赖项的信息。</div></li><li><div><span style="font-weight: bold;">RHEL 8中已使用dnf命令来替代yum命令，而yum命令为dnf命令的软链接。</span></div></li></ul><div>     <img src="chapter14_files/Image [9].png" type="image/png" data-filename="Image.png" width="497"/></div><div><br/></div><ul><li><div>常用yum命令示例：</div></li></ul><div>     $ yum help：查看yum使用方法</div><div>     $ yum list &lt;<span style="font-style: italic;">pattern</span>&gt;：查看已安装与可用的软件包</div><div>     <img src="chapter14_files/Image [10].png" type="image/png" data-filename="Image.png" width="577"/></div><div><br/></div><div>     $ yum search &lt;<span style="font-style: italic;">keyword</span>&gt;：搜索匹配关键字的软件包</div><div>     <span style="font-weight: bold;">$ yum search all &lt;</span><span style="font-style: italic; font-weight: bold;">keyword</span><span style="font-weight: bold;">&gt;</span>：搜索匹配关键字的软件包</div><div>     <img src="chapter14_files/Image [11].png" type="image/png" data-filename="Image.png" width="577"/></div><div><br/></div><div>     $ yum info &lt;<span style="font-style: italic;">package_name</span>&gt;：查看软件包的详细信息</div><div>     <img src="chapter14_files/Image [12].png" type="image/png" data-filename="Image.png" width="577"/></div><div><br/></div><div>     <span style="font-weight: bold;">$ yum provides &lt;</span><span style="font-style: italic; font-weight: bold;">pattern</span><span style="font-weight: bold;">&gt;</span>：查看指定文件由哪个软件包提供</div><div>     <img src="chapter14_files/Image [13].png" type="image/png" data-filename="Image.png" width="579"/></div><div><br/></div><div>     $ yum install &lt;<span style="font-style: italic;">package_name</span>&gt;：安装软件包及依赖包</div><div>     $ yum update &lt;<span style="font-style: italic;">package_name</span>&gt;：更新指定软件包及依赖包</div><div>       <span style="color: rgb(0, 0, 255); font-weight: bold;">* 注意：</span><span style="font-weight: bold;">内核升级可以通过 yum update kernel 实现，而且会多个内核共存。</span></div><div>     $ yum update：更新系统所有软件包</div><div>     $ yum remove &lt;<span style="font-style: italic;">package_name</span>&gt;：卸载软件包</div><div>       <span style="color: rgb(0, 0, 255); font-weight: bold;">* 注意：</span>使用yum命令卸载软件包将卸载相关依赖包！</div><div><br/></div><div><span style="font-weight: bold;">使用yum安装与卸载软件包组：</span></div><ul><li><div>yum具有组（group）的概念，组为针对特定目的而一起安装的相关软件集合。</div></li><li><div>在RHEL 8中，有两种类型的组。</div></li><li><div><span style="font-weight: bold;">常规组（regular groups）是软件包的集合，环境组（environment groups）是常规组的集合。</span></div></li><li><div>组中软件包可能为mandatory（安装该组时必须安装）、default（安装该组时通常会安装）</div></li></ul><div>     或optional（安装该组时不安装，除非特别要求）。</div><div><br/></div><ul><li><div><span style="font-weight: bold;">$ yum group list</span>：查看已安装的与可用的软件包组</div></li></ul><div>     <span style="font-weight: bold;">$ yum group list hidden</span>：列出隐藏的软件包组</div><div>     <img src="chapter14_files/Image [14].png" type="image/png" data-filename="Image.png" width="576"/></div><div><br/></div><ul><li><div><span style="font-weight: bold;">$ yum group info &lt;</span><span style="font-style: italic; font-weight: bold;">group_name</span><span style="font-weight: bold;">&gt;</span>：查看软件包组的详细信息，包含必须、默认与可选的软件包。</div></li></ul><div>     <img src="chapter14_files/Image [15].png" type="image/png" data-filename="Image.png" width="577"/></div><div><br/></div><ul><li><div>$ yum group install &lt;<span style="font-style: italic;">group_name</span>&gt;：安装软件包组，包含必须、默认与依赖的软件包。</div></li></ul><div>     <img src="chapter14_files/Image [16].png" type="image/png" data-filename="Image.png" width="498"/></div></div><div><br/></div><div><span style="font-weight: bold;">查看yum事务历史：</span></div><ul><li><div>/var/log/dnf.rpm.log：记录所有安装与卸载的事务日志</div></li></ul><div>     <img src="chapter14_files/Image [17].png" type="image/png" data-filename="Image.png" width="498"/></div><div><br/></div><ul><li><div><span style="font-weight: bold;">$ yum history</span>：显示安装与卸载的事务日志</div></li></ul><div>     <img src="chapter14_files/Image [18].png" type="image/png" data-filename="Image.png" width="577"/></div><div><br/></div><ul><li><div><span style="font-weight: bold;">$ yum history undo &lt;</span><span style="font-style: italic; font-weight: bold;">transaction_id</span><span style="font-weight: bold;">&gt;</span>：撤销yum事务</div></li></ul><div>     <img src="chapter14_files/Image [19].png" type="image/png" data-filename="Image.png" width="498"/></div><div><br/></div><div><span style="font-weight: bold;">yum命令摘要：</span></div><ul><li><div>如下所示：</div></li></ul><div>     <img src="chapter14_files/Image [20].png" type="image/png" data-filename="Image.png" width="499"/></div><div><br/></div><div>     <span style="color: rgb(250, 122, 0); font-weight: bold;">练习 P497：</span><span style="color: rgb(250, 122, 0); font-weight: bold;">INSTALLING AND UPDATING SOFTWARE PACKAGES WITH YUM</span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">第四节：启用yum软件仓库</span></div><div><span style="font-weight: bold;">目标：</span></div><ul><li><div>完成本节后，学生应该能启用和禁用供服务器使用的红帽或第三方yum仓库。</div></li></ul><div><br/></div><div><span style="font-weight: bold;">启用红帽软件仓库：</span></div><ul><li><div>将系统注册到订阅服务后，可根据所附加的订阅，自动配置软件仓库的访问。</div></li></ul><div>     <img src="chapter14_files/Image [21].png" type="image/png" data-filename="Image.png" width="497"/></div><div><br/></div><ul><li><div>yum-config-manager命令可用于启用或禁用软件仓库。</div></li></ul><div>     <img src="chapter14_files/Image [22].png" type="image/png" data-filename="Image.png" width="500"/> </div><div><br/></div><ul><li><div>非红帽来源通过第三方仓库提供软件，可以通过yum命令从网站、FTP服务器或本地</div></li></ul><div>     文件系统进行访问。</div><ul><li><div>要启用对第三方仓库的支持，可在/etc/yum.repos.d/目录中创建一个仓库配置文件。</div></li><li><div>仓库配置文件必须以 .repo 扩展名结尾。</div></li></ul><div><br/></div><div><span style="font-weight: bold;">创建yum软件仓库：</span></div><ul><li><div>创建yum软件仓库的两种方法：</div></li></ul><div>     1. 使用yum-config-manager命令创建</div><div>     2. 编辑/etc/yum.repos.d/*.repo仓库配置文件创建</div><div><br/></div><ul><li><div>方法一：使用yum-config-manager命令添加并启用EPEL 8软件仓库</div></li></ul><div>     <span style="font-weight: bold;">$ yum-config-manager --add-repo &lt;</span><span style="font-style: italic; font-weight: bold;">url</span><span style="font-weight: bold;">&gt;</span>：添加并启用URL指定的软件仓库</div><div>     <span style="color: rgb(0, 0, 255); font-weight: bold;">* 注意：</span></div><div><span style="color: rgb(0, 0, 255); font-weight: bold;">     </span>  1. <span style="font-weight: bold;">dnf-utils软件包提供 yum-config-manager 命令与 yumdownloader 命令。</span></div><div>       2. 教材给出的Fedora软件仓库不可用，该示例使用清华大学的EPEL 8软件仓库，速度更佳。</div><div>     <img src="chapter14_files/Image [23].png" type="image/png" data-filename="Image.png" width="577"/></div><div><br/></div><div>     $ yum-config-manager --enable &lt;<span style="font-style: italic;">repo_id</span>&gt;：启用指定的软件仓库</div><div>     $ yum-config-manager --disable &lt;<span style="font-style: italic;">repo_id</span>&gt;：禁用指定的软件仓库</div><div><br/></div><ul><li><div>方法二：通过编辑/etc/yum.repos.d/*.repo文件创建</div></li></ul><div>     <img src="chapter14_files/Image [24].png" type="image/png" data-filename="Image.png" width="578"/> </div><div><br/></div><div>     <span style="color: rgb(0, 0, 255); font-weight: bold;">* 注意：</span></div><div>       1. RHEL 8使用rpm软件包安装EPEL 8软件仓库</div></div><div>          a. 安装EPEL 8软件源 </div><div>          <img src="chapter14_files/Image [25].png" type="image/png" data-filename="Image.png" width="539"/></div><div><br/></div><div>          b. 查看epel.repo仓库配置文件</div><div>          <img src="chapter14_files/Image [26].png" type="image/png" data-filename="Image.png" width="540"/></div><div><br/></div><div>          c. 查看EPEL 8软件仓库状态，只需epel软件仓库可用即可。</div><div>          <img src="chapter14_files/Image [27].png" type="image/png" data-filename="Image.png" width="539"/></div><div><br/></div><div>     2. RHEL 8配置CentOS 8额外软件源：/etc/yum.repos.d/mirror-centos8.repo</div><div>        <img src="chapter14_files/Image [28].png" type="image/png" data-filename="Image.png" width="473"/></div><div>        <img src="chapter14_files/Image [29].png" type="image/png" data-filename="Image.png" width="554"/></div><div>       </div><div>     <span style="color: rgb(250, 122, 0); font-weight: bold;">练习 P505：</span><span style="color: rgb(250, 122, 0); font-weight: bold;">ENABLING YUM SOFTWARE REPOSITORIES</span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">第五节：管理软件包模块流</span></div><div><span style="font-weight: bold;">目标：</span></div><ul><li><div>完成本节后，学生应该能：</div></li><li><div>  解释如何通过模块安装特定版本的软件。</div></li><li><div>  如何列出、启用和切换模块流。</div></li><li><div>  从模块安装和更新软件包。</div></li></ul><div><br/></div><div><span style="font-weight: bold;">应用流简介：application stream</span></div><ul><li><div><span style="font-weight: bold;">RHEL 8引入了应用流的概念，可同时随发行版提供多个版本的用户空间软件包。</span></div></li><li><div>它们可能比核心操作系统软件包更新得更频繁。</div></li><li><div><span style="font-weight: bold;">传统上如果开发人员想要最新版本的应用，而管理员希望使用最稳定版本，会造成</span></div></li></ul><div><span style="font-weight: bold;">     一种难以管理的局面。</span></div><div><span style="font-weight: bold;">   </span> <span style="color: rgb(0, 0, 255); font-weight: bold;"> * 注意：</span></div><div>       1. AppStream软件仓库中新旧版本的依赖包能很容易卸载，不会与BaseOS软件仓库</div><div>          中的软件包相冲突。</div><div><br/></div><ul><li><div>RHEL 8中运用一种称为模块化（modularity）的新技术简化了这个过程。</div></li><li><div>模块化允许单个仓库（AppStream）承载多个版本的应用软件包及其依赖项关系。</div></li></ul><div><br/></div><ul><li><div><span style="font-weight: bold;">RHEL 8内容通过两个主要的软件仓库进行分发：BaseOS、AppStream。</span></div></li><li><div>BaseOS：</div></li></ul><div>     1. 以RPM软件包的形式为RHEL提供核心操作系统内容。</div><div>     2. <span style="font-weight: bold;">BaseOS组件的生命周期与RHEL发行版中的内容相同。</span></div><ul><li><div>Application Stream：</div></li></ul><div>     1. 提供具有不同生命周期的内容，作为模块和传统RPM软件包。</div><div>     2. <span style="font-weight: bold;">模块描述了属于一个整体的一组RPM软件包。</span></div><ul><li><div>模块可以包含多个流（stream），使多个版本的应用可供安装。</div></li><li><div>启用模块流后，系统能够访问该模块流中的RPM软件包。</div></li></ul><div><br/></div><div><span style="font-weight: bold;">模块：modules</span></div><ul><li><div>模块是一组相关联的RPM软件包。</div></li><li><div>Module Streams：</div></li></ul><div>     1. <span style="font-weight: bold;">每个模块可以具有一个或多个模块流，其包含不同版本的内容。</span></div><div>     2. 每个流独立接收更新。</div><div>     3. 模块流可以视为应用流仓库中的虚拟仓库。</div><ul><li><div>Module Profiles：</div></li></ul><div>     1. 每个模块可以有一个或多个profile文件。</div><div>     2. profile文件是一起安装的某些软件包的列表，列表包括服务端、客户端、开发或最小安装等。</div><div><br/></div><div><span style="font-weight: bold;">使用yum管理模块：</span></div><ul><li><div>RHEL 8使用Yum version 4（dnf）支持应用流中的模块特性。</div></li><li><div>$ yum module list：查看可用的模块列表</div></li></ul><div>     <img src="chapter14_files/Image [30].png" type="image/png" data-filename="Image.png" width="577"/></div><div>     <img src="chapter14_files/Image [31].png" type="image/png" data-filename="Image.png" width="578"/></div><div><br/></div><ul><li><div>$ yum module list &lt;<span style="font-style: italic;">module_name</span>&gt;[:&lt;<span style="font-style: italic;">stream</span>&gt;]：查看指定模块的所有模块流与profile文件信息</div></li></ul><div>     <img src="chapter14_files/Image [32].png" type="image/png" data-filename="Image.png" width="578"/></div><div><br/></div><ul><li><div>$ yum module info &lt;<span style="font-style: italic;">module_name</span>&gt;[:&lt;<span style="font-style: italic;">stream</span>&gt;]：查看模块的详细信息</div></li></ul><div>     <img src="chapter14_files/Image [33].png" type="image/png" data-filename="Image.png" width="578"/></div><div><br/></div><ul><li><div><span style="font-weight: bold;">$ yum module info --profile &lt;</span><span style="font-weight: bold; font-style: italic;">module_name</span><span style="font-weight: bold;">&gt;[:&lt;</span><span style="font-weight: bold; font-style: italic;">stream</span><span style="font-weight: bold;">&gt;]</span>：查看指定模块的profile文件信息</div></li></ul><div>     <img src="chapter14_files/Image [34].png" type="image/png" data-filename="Image.png" width="580"/></div><div><br/></div><div><span style="font-weight: bold;">启用模块流与安装模块：</span></div><ul><li><div>yum module enable必须启用模块流才能安装其模块。</div></li><li><div>对于指定模块，只能启用一个模块流，其它模块流将被禁用。</div></li></ul><div><br/></div><ul><li><div>$ yum module install -y &lt;<span style="font-style: italic;">module_name</span>&gt;[:&lt;<span style="font-style: italic;">stream</span>&gt;]：安装指定模块流的模块</div></li></ul><div>     <span style="font-weight: bold;">$ yum install @perl</span>：该命令与模块化安装效果相同，@表示模块名。</div><div>     <img src="chapter14_files/Image [35].png" type="image/png" data-filename="Image.png" width="579"/></div><div><br/></div><div><span style="font-weight: bold;">卸载模块与禁用模块流：</span></div><ul><li><div>删除模块会删除当前启用的模块流的profile所安装的所有软件包，以及依赖于这些软件包的</div></li></ul><div>     任何其他软件包和模块。</div><ul><li><div>从此模块流安装的软件包如果未在其profile文件中列出，则依然安装在系统上，可手动删除。</div></li></ul><div>     <span style="color: rgb(0, 0, 255); font-weight: bold;">* 注意：</span></div><div>       1. <span style="font-weight: bold;">切换模块流：重置当前流并启用新流</span></div><div>       2. 它不会自动更改任何已安装的软件包，必须手动来完成。</div><div>       3. 卸载模块需谨慎行事！</div><div><br/></div></div><ul><li><div>$ yum module remove -y &lt;<span style="font-style: italic;">module_name</span>&gt;[:&lt;<span style="font-style: italic;">stream</span>&gt;]：卸载已安装的模块</div></li></ul><div>     <img src="chapter14_files/Image [36].png" type="image/png" data-filename="Image.png" width="498"/></div><div>     <img src="chapter14_files/Image [37].png" type="image/png" data-filename="Image.png" width="499"/></div><div><br/></div><div><span style="font-weight: bold;">切换模块流：</span></div><ul><li><div><span style="font-weight: bold;">切换模块流通常需要将内容升级或降级到不同版本。</span></div></li><li><div>为确保顺利切换，应首先删除模块流提供的模块。</div></li><li><div>将删除模块的profile文件所安装的所有软件包，以及这些软件包依赖的任何模块和软件包。</div></li></ul><div><br/></div><ul><li><div><span style="color: rgb(0, 0, 255); font-weight: bold;">切换模块流步骤：删除旧模块、重置旧模块、启用并安装新模块。</span></div></li></ul><div><br/></div><ul><li><div>切换postgresql模块流，如下所示：</div></li></ul><div>     $ yum module list --installed</div><div>     $ yum module remove postgresql:9.6</div><div>     <span style="font-weight: bold;">$ yum module reset postgresql</span></div><div>     <img src="chapter14_files/Image [38].png" type="image/png" data-filename="Image.png" width="577"/></div><div><br/></div><div>     $ yum module install -y postgresql:10</div><div>     <img src="chapter14_files/Image [39].png" type="image/png" data-filename="Image.png" width="578"/></div><div><br/></div><div>     <span style="color: rgb(250, 122, 0); font-weight: bold;">练习 P515：</span><span style="color: rgb(250, 122, 0); font-weight: bold;">MANAGING PACKAGE MODULE STREAMS</span></div><div><span style="color: rgb(250, 122, 0); font-weight: bold;">     Lab P519：INSTALLING AND UPDATING SOFTWARE PACKAGES</span></div><div><br/></div><div><br/></div></div><div><br/></div></span>
</div></body></html> 