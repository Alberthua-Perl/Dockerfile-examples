<html>
<head>
  <title>第六章 管理本地用户和组</title>
  <basefont face="Consolas" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/308816 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: Consolas;
      font-size: 11pt;
    }
  </style>
</head>
<body>
<a name="2864"/>

<div>
<span><div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(0, 0, 255); font-weight: bold;">第六章 管理本地用户和组</span></font></div><div><br/></div><div><span style="font-weight: bold;">目标：</span></div><div><ul><li><div><span style="font-size: 11pt;">创建、管理和删除本地用户和组，并且管理本地密码策略。</span></div></li></ul><div><br/></div></div><div><span style="font-weight: bold;">章节：</span></div><div><ul><li><div><span style="font-size: 11pt;">描述用户和组概念</span></div></li><li><div><span style="font-size: 11pt;">获取超级用户访问权限</span></div></li><li><div><span style="font-size: 11pt;">管理本地用户账号</span></div></li><li><div><span style="font-size: 11pt;">管理本地组账号</span></div></li><li><div><span style="font-size: 11pt;">管理用户密码</span></div></li></ul><div><br/></div></div><div><br/></div><div><span style="font-weight: bold;">第一节：描述用户和组概念</span></div><div><span style="font-weight: bold;">目标：</span></div><div><ul><li><div><span style="font-size: 11pt;">完成本节后，学生应该能描述Linux系统上用户和组的用途。</span></div></li></ul><div><span style="font-size: 14.6667px;"><br/></span></div></div><div><span style="font-size: 14.6667px;"><span style="font-size: 14.6667px; font-weight: bold;">什么是用户?</span></span></div><div><ul><li><div>用户账户为不同人员和运行的程序之间提供安全边界。</div></li><li><div><span style="font-weight: bold;">用户使用用户名（username）进行标识，操作系统为其分配唯一标识号（UID），用户可能含有密码。</span></div></li><li><div>系统中的每个程序都以一个特定用户运行，即系统用户。</div></li><li><div>每个文件都有一个特定用户作为所有者用户账户</div></li><li><div>用户的三种主要类型：</div></li></ul><div>     1. 超级用户（superuser）：root用户，UID=0，具有系统的最高权限。</div><div>     2. 系统用户（system user）：用于系统管理，如运行服务与守护进程等，不需要用于系统登录。</div><div>     3. 普通用户（regular user）： 供用户进行日常系统管理，通常具有权限限制。</div><div><br/></div></div><ul><li><div>id命令：查看当前登录的用户或指定的用户信息</div></li></ul><div>     <img src="chapter6_files/Image.png" type="image/png" data-filename="Image.png" width="496"/> </div><div>     <img src="chapter6_files/Image [1].png" type="image/png" data-filename="Image.png" width="495"/></div><div><br/></div><div>     <span style="font-weight: bold; color: rgb(0, 0, 255);">* 注意：</span></div><div>       1. <span style="font-weight: bold;">用户可存在于本地操作系统，也可由统一管理用户的外部身份认证系统提供。</span></div><div>       2. 可根据用户UID反向查看对应的用户名，并且由外部身份认证系统提供的用户，其用户名</div><div>          不在/etc/passwd中显示！</div><div>       3. <b>$ getent passwd &lt;<i>uid</i>&gt;</b>：根据UID反向查找相应的用户名<br/></div><div>       <img src="chapter6_files/Linux集成LDAP用户.JPG" type="image/jpeg" data-filename="Linux集成LDAP用户.JPG" width="483"/></div><div><br/></div><ul><li><div>ls -l命令查看文件所属用户，ls -ld命令查看目录所属用户。</div></li></ul><div>     <img src="chapter6_files/Image [2].png" type="image/png" data-filename="Image.png" width="497"/></div><div><br/></div><ul><li><div>ps命令：查看进程的信息</div></li></ul><div>     -a选项显示当前终端的进程，-u选项显示进程关联的用户信息。</div><div>     <img src="chapter6_files/Image [3].png" type="image/png" data-filename="Image.png" width="497"/></div><div><br/></div><ul><li><div>虽然命令中显示用户名，但是系统中使用UID追踪用户。</div></li><li><div><span style="font-weight: bold;">/etc/passwd用户数据库文件定义用户名和UID的关联关系。</span></div></li></ul><div>     <img src="chapter6_files/Image [4].png" type="image/png" data-filename="Image.png" width="497"/></div><div><br/></div><div><span style="font-weight: bold;">什么是组?</span></div><ul><li><div>组是用户的集合，组中用户共享文件和其他系统资源的访问权限。</div></li><li><div><span style="font-weight: bold;">组有组名（group name）和GID，匹配关系保存在/etc/group文件中。</span></div></li></ul><div>     <img src="chapter6_files/Image [5].png" type="image/png" data-filename="Image.png" width="497"/></div><div><br/></div><div><span style="font-weight: bold;">主要组（primary groups）与补充组（supplementary groups）：</span></div><ul><li><div>每个用户只属于一个主要组，对应的GID在/etc/passwd中。</div></li><li><div>创建新用户时同时创建同名的主要组，用户作为此组的唯一用户。</div></li><li><div><span style="font-weight: bold;">用户还可以属于补充组（或称次要组），对应GID在/etc/group中。</span></div></li><li><div>同一组中的不同用户拥有组对文件的相同权限。</div></li><li><div>id命令可以显示用户的组信息，如下所示：</div></li></ul><div>     <img src="chapter6_files/Image [6].png" type="image/png" data-filename="Image.png" width="499"/></div><div><br/></div><div>     <span style="color: rgb(250, 122, 0); font-weight: bold;">练习 P165：</span><span style="color: rgb(250, 122, 0); font-weight: bold;">DESCRIBING USER AND GROUP CONCEPTS</span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">第二节：获取超级用户访问权限</span></div><div><span style="font-weight: bold;">目标：</span></div><ul><li><div>完成本节后，学生应该能切换超级用户账户管理Linux系统，并且通过sudo命令授予</div></li></ul><div>     其他用户超级用户访问权限。</div><div><br/></div><div><span style="font-weight: bold;">超级用户：</span></div><ul><li><div>RHEL中的超级用户为root，具备最高权限（也有最高的破坏力）。</div></li><li><div>只有root用户才能进行软件安装删除、系统文件管理、用户管理等任务。</div></li><li><div>普通用户可以管理移动存储，root用户才能管理固定硬盘。</div></li><li><div>Red Hat建议管理员以普通用户身份登录，有需要时再切换到root用户。</div></li></ul><div><br/></div><div><span style="font-weight: bold;">切换用户：</span></div><ul><li><div>su命令：用于进行用户切换</div></li><li><div>普通用户之间切换需要输入密码，root切换到普通用户不需要输入密码。</div></li></ul><div>     <img src="chapter6_files/Image [7].png" type="image/png" data-filename="Image.png" width="497"/></div><div><br/></div><ul><li><div>su启动非登录shell（<span style="font-style: italic;">non-login shell</span>），使用原始用户的环境设置。</div></li></ul><div>     <img src="chapter6_files/Image [8].png" type="image/png" data-filename="Image.png" width="497"/></div><div><br/></div><ul><li><div><span style="color: rgb(0, 0, 255); font-weight: bold;">su - 启动登录shell（</span><span style="color: rgb(0, 0, 255); font-style: italic; font-weight: bold;">login shell</span><span style="color: rgb(0, 0, 255); font-weight: bold;">），导入该用户的环境设置（推荐）。</span></div></li></ul><div><span style="color: rgb(0, 0, 255); font-weight: bold;">     </span><span style="color: rgb(0, 0, 255); font-weight: bold;"><img src="chapter6_files/Image [9].png" type="image/png" data-filename="Image.png" width="497"/></span></div><div><br/></div><div><span style="font-weight: bold;">使用SUDO运行命令：</span></div><ul><li><div>普通用户使用sudo可以获取root用户的访问权限。</div></li><li><div>sudo需要用户输入普通用户自己的密码以进行身份验证。</div></li></ul><div>     <img src="chapter6_files/Image [10].png" type="image/png" data-filename="Image.png" width="497"/></div><div><br/></div><ul><li><div>通过sudo运行的命令，会在<span style="font-weight: bold;">/var/log/secure</span>中记录日志。</div></li></ul><div>     <img src="chapter6_files/Image [11].png" type="image/png" data-filename="Image.png" width="576"/></div><div><br/></div><ul><li><div>在RHEL 7和RHEL 8中，属于wheel组的用户，可以运行sudo提权为root用户。</div></li><li><div>RHEL 6中属于wheel组的用户无法使用sudo提权为root用户。</div></li></ul><div><br/></div><div><span style="font-weight: bold;">使用Sudo获取交互式Root Shell：</span></div><ul><li><div>使用su命令切换至root用户需要root密码，存在安全风险，因此可使用sudo命令提权至root用户</div></li></ul><div>     而无需root密码。</div><ul><li><div>$ sudo su -：使具有sudo权限的普通用户获得root shell，需输入自身密码，而不需输入root密码。</div></li><li><div>$ sudo -i：将普通用户切换到root shell</div></li></ul><div>     <img src="chapter6_files/Image [12].png" type="image/png" data-filename="Image.png" width="577"/></div><div><br/></div><div><span style="color: rgb(0, 0, 255); font-weight: bold;">   * 注意：</span></div><div>     1. sudo su - 和 sudo -i 略有不同。</div><div>     2. <span style="font-weight: bold;">sudo su - 将完全切换至root用户的环境变量，而sudo -i的环境变量可能会不同。</span></div><div><span style="font-weight: bold;">     </span><span style="font-weight: bold;"><img src="chapter6_files/Image [13].png" type="image/png" data-filename="Image.png" width="497"/></span></div><div>     </div><div><span style="font-weight: bold;">配置Sudo：</span></div><ul><li><div>sudo的主配置文件是/etc/sudoers，建议采用visudo命令进行编辑。</div></li><li><div>/etc/sudoers配置示例：</div></li></ul><div>     1. %wheel：指定用户组wheel</div><div>     2. ALL=(ALL)：定义可以在任意主机上的对应命令，wheel可以运行任意命令。</div><div>     3. ALL：wheel可以任意用户身份运行此命令</div><div>        <img src="chapter6_files/Image [14].png" type="image/png" data-filename="Image.png" width="474"/></div><div><br/></div><ul><li><div>/etc/sudoers.d目录也可以存放配置文件</div></li><li><div>如下所示：/etc/sudoers.d/user01（此方法需要交互输入普通用户密码）</div></li></ul><div>     <img src="chapter6_files/Image [15].png" type="image/png" data-filename="Image.png" width="496"/></div><ul><li><div>使用如下方法不输入普通用户密码运行sudo命令：在ansible中非常有用</div></li></ul><div>     <img src="chapter6_files/Image [16].png" type="image/png" data-filename="Image.png" width="497"/></div><div><br/></div><div>   <span style="color: rgb(0, 0, 255); font-weight: bold;">* 注意：</span></div><div>     1. 使用SSH登录云实例（instance）时，需指定特定用户的私钥来登录，再使用sudo</div><div>        提权至root用户。</div><div><br/></div><div>     <span style="color: rgb(250, 122, 0); font-weight: bold;">练习 P174：</span><span style="color: rgb(250, 122, 0); font-weight: bold;">GAINING SUPERUSER ACCESS</span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">第三节：管理本地用户账号</span></div><div><span style="font-weight: bold;">目标：</span></div><ul><li><div>完成本节后，学生应该能创建、修改与删除本地用户账号。</div></li></ul><div><br/></div><div><span style="font-weight: bold;">创建用户：</span></div><ul><li><div>$ useradd &lt;<span style="font-style: italic;">username</span>&gt;：创建新用户及其主要组，并创建用户默认家目录和用户信息。</div></li><li><div>$ useradd --help：查看useradd命令的选项和参数</div></li><li><div><span style="font-weight: bold;">/etc/login.defs中定义新用户的UID范围和密码生命周期等。</span></div></li><li><div><span style="font-weight: bold;">更改该文件中的指定值不影响</span><span style="font-weight: bold;">当前已存在的用户，只影响新创建的用户！</span></div></li></ul><div><span style="font-weight: bold;">     </span><span style="font-weight: bold;"><img src="chapter6_files/Image [17].png" type="image/png" data-filename="Image.png" width="406"/></span></div><div><span style="font-weight: bold;">   </span></div><div><span style="font-weight: bold;">   </span><span style="color: rgb(54, 101, 238); font-weight: bold;">* 注意：</span><span style="font-weight: bold;">/etc/skel目录中包含用户默认环境变量脚本文件</span></div><div><br/></div><div><span style="font-weight: bold;">修改已存在的用户：</span></div><ul><li><div>$ usermod --help：查看usermod命令的选项与参数</div></li><li><div>如下所示：</div></li></ul><div>     <img src="chapter6_files/Image [18].png" type="image/png" data-filename="Image.png" width="496"/></div><div>     <img src="chapter6_files/Image [19].png" type="image/png" data-filename="Image.png" width="496"/></div><div><br/></div><div>   <span style="color: rgb(0, 0, 255); font-weight: bold;">* 注意：</span></div><div>     1. 影子用户：具有相同UID，但用户名不同的用户。</div><div>     2. 使用影子用户后，两个不同用户名的用户具有相同的UID，即使删除其中一个用户后</div><div>        另一用户依然不受影响。</div><div>     3. <span style="font-weight: bold;">但删除影子用户时，不要使用 -r 选项，否则将删除用户家目录的所有数据！</span></div><div>     4. Red Hat操作系统中可使用影子账户，SUSE操作系统中无法使用影子账户。</div><div>        <img src="chapter6_files/Image [20].png" type="image/png" data-filename="Image.png" width="473"/></div><div><br/></div><div><span style="font-weight: bold;">删除用户：</span></div><ul><li><div>$ userdel &lt;<span style="font-style: italic;">username</span>&gt;：从/etc/passwd文件中删除普通用户，但保留该用户家目录与邮件文件。</div></li><li><div>$ userdel -r &lt;<span style="font-style: italic;">username</span>&gt;：从/etc/passwd文件中删除普通用户，同时删除该用户家目录与邮件文件。</div></li><li><div>用户的邮件文件：/var/spool/mail/&lt;<span style="font-style: italic;">username</span>&gt;</div></li></ul><div><br/></div><ul><li><div>如果在未指定-r选项的情况下使用userdel删除某一用户，系统将具有未分配UID所拥有的⽂件，</div></li></ul><div>     这些文件的所有者为已删除的用户。</div><ul><li><div>当由已删除用户拥有的⽂件在该用户的主目录之外存在时，也会发⽣这种情况。</div></li><li><div>这种情况将导致信息泄露和其他安全问题。</div></li></ul><div><br/></div><ul><li><div><span style="font-weight: bold;">在RHEL 7和RHEL 8 中，useradd命令为新用户分配第一个大于或等于1000的可用UID，</span></div></li></ul><div><span style="font-weight: bold;">     除非通过-u选项明确指定UID。</span></div><ul><li><div>以上为信息泄露产生的原因。</div></li></ul><div><br/></div><ul><li><div><span style="font-weight: bold;">如果第一个可用UID先前被分配给了一个从系统中删除的用户账户，那么旧用户的UID将被重新</span></div></li></ul><div><span style="font-weight: bold;">     分配给新用户，以便为新用户提供旧用户剩余文件的所有权。</span></div><div>     <img src="chapter6_files/Image [21].png" type="image/png" data-filename="Image.png" width="496"/></div><div><br/></div><ul><li><div><span style="font-weight: bold;">$ find / -nouser -o -nogroup</span>：查找无所有者的文件与目录</div></li></ul><div><br/></div><div><span style="font-weight: bold;">设置密码：</span></div><ul><li><div>$ passwd &lt;<span style="font-style: italic;">username</span>&gt;：初始化或更改用户现有密码</div></li><li><div>root用户可以为任何用户设置密码，普通用户只可以修改自己的密码。</div></li><li><div>若更改的密码过于简单或基于Linux字典，设置时将显示安全提示。</div></li></ul><div>     <img src="chapter6_files/Image [22].png" type="image/png" data-filename="Image.png" width="496"/></div><div><br/></div><ul><li><div>普通用户必须选择长度至少为8个字符，并且还不以字典词语、用户名或上一密码为基础的密码。</div></li></ul><div><br/></div><div><span style="font-weight: bold;">UID范围：</span></div><ul><li><div>UID 0永远分配给root用户</div></li><li><div>UID 1-200分配给system users（红帽的系统服务）</div></li><li><div>UID 201-999分配给system users，供文件系统中没有自己的文件的系统进程使用。</div></li></ul><div>     通常在安装需要它们的软件时，从可用池中动态分配它们。</div><div>     程序以这些“无特权”系统用户身份运行，它们仅访问运行所需的资源。</div><ul><li><div>UID 1000+（包含1000）分配给普通用户</div></li></ul><div>   <span style="color: rgb(0, 0, 255); font-weight: bold;">* 注意：</span>RHEL 7之前，UID 1-499分配给系统用户，UID 500+分配给普通用户。</div><div><br/></div><div>     <span style="color: rgb(250, 122, 0); font-weight: bold;">练习 P182：</span><span style="color: rgb(250, 122, 0); font-weight: bold;">MANAGING LOCAL USER ACCOUNTS</span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">第四节：管理本地组账号</span></div><div><span style="font-weight: bold;">目标：</span></div><ul><li><div>完成本节后，学生应该能创建、修改与删除本地组账号。</div></li></ul><div><br/></div><div><span style="font-weight: bold;">创建组：</span></div><ul><li><div>groupadd命令创建用户组</div></li><li><div>$ groupadd -g &lt;<span style="font-style: italic;">GID</span>&gt; &lt;<span style="font-style: italic;">groupname</span>&gt;：指定GID创建组，建议使用1000以上的GID。</div></li></ul><div>     <img src="chapter6_files/Image [23].png" type="image/png" data-filename="Image.png" width="498"/></div><div>    </div><ul><li><div>$ groupadd -r &lt;<span style="font-style: italic;">groupname</span>&gt;：创建系统用户组</div></li></ul><div>     <img src="chapter6_files/Image [24].png" type="image/png" data-filename="Image.png" width="497"/></div><div><br/></div><div><span style="font-weight: bold;">修改已存在的组：</span></div><ul><li><div>$ groupmod -n &lt;<span style="font-style: italic;">new_groupname</span>&gt; &lt;<span style="font-style: italic;">old_goupname</span>&gt;：更改用户组名称</div></li><li><div>$ groupmod -g &lt;<span style="font-style: italic;">GID</span>&gt; &lt;<span style="font-style: italic;">groupname</span>&gt;：指定或更改用户组GID     </div></li></ul><div><br/></div><div><span style="font-weight: bold;">删除组：</span></div><ul><li><div>$ groupdel &lt;<span style="font-style: italic;">groupname</span>&gt;：删除用户组</div></li></ul><div>     <img src="chapter6_files/Image [25].png" type="image/png" data-filename="Image.png" width="496"/></div><div><br/></div><div><span style="font-weight: bold;">更改组成员：</span></div><ul><li><div><span style="font-weight: bold;">$ usermod -g &lt;</span><span style="font-style: italic; font-weight: bold;">GID</span><span style="font-weight: bold;">&gt; &lt;</span><span style="font-style: italic; font-weight: bold;">username</span><span style="font-weight: bold;">&gt;</span>：更改用户的主要组（primary group）</div></li></ul><div>     <img src="chapter6_files/Image [26].png" type="image/png" data-filename="Image.png" width="496"/></div><div><br/></div><ul><li><div><span style="font-weight: bold;">$ usermod -aG &lt;</span><span style="font-style: italic; font-weight: bold;">groupname</span><span style="font-weight: bold;">&gt; &lt;</span><span style="font-style: italic; font-weight: bold;">username</span><span style="font-weight: bold;">&gt;</span>：将用户添加至次要组</div></li></ul><div>     <img src="chapter6_files/Image [27].png" type="image/png" data-filename="Image.png" width="498"/></div><div><br/></div><ul><li><div>使⽤-a选项可使usermod命令处于append模式。</div></li><li><div><span style="font-weight: bold;">如果没有-a选项，就会从当前未包含在-G选项列表中的任何次要组中删除该用户。</span></div></li></ul><div>     <img src="chapter6_files/Image [28].png" type="image/png" data-filename="Image.png" width="498"/></div><div><br/></div><div><span style="color: rgb(250, 122, 0); font-weight: bold;">     练习 P188：MANAGING LOCAL GROUP ACCOUNTS</span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">第五章：管理用户密码</span></div><div><span style="font-weight: bold;">目标：</span></div><ul><li><div>完成本节后，学生应该能为用户设置密码管理策略，并且手动锁定与解锁用户账号。</div></li></ul><div><br/></div><div><span style="font-weight: bold;">影子密码与密码策略：</span></div><ul><li><div>以前密码保存在/etc/passwd文件中，所有用户皆可读。</div></li><li><div>之后将密码保存到只有root用户可读的/etc/shadow文件中，文件格式如下所示：</div></li></ul><div>     <img src="chapter6_files/Image [29].png" type="image/png" data-filename="Image.png" width="500"/></div><div>     1. 此密码所属账户的用户名</div><div>     2. 此用户的加密密码</div><div>     3. <span style="font-weight: bold;">上次更改密码的日期</span>（-d）：设置值为自1970-01-01起的天数，并按UTC时区计算。</div><div>     4. 密码最小生命周期（-m）：从上次更改密码到这次更改密码的间隔天数。</div><div>     5. 密码最大生命周期（-M）：</div><div>        密码过期时间，即在密码过期之前不进行密码更改可以经过的最长天数。</div><div>        空字段表示它不会根据上次更改以来的时间失效。</div><div>     6. 警告期（-W）：当用户在密码过期日之前登录达到该天数时，会收到有关密码过期的警告。</div><div>     7. <span style="font-weight: bold;">非活动期</span>（-I）：一旦密码过期，在这些天内仍可以接受登录，过了这一时期后，账户将被锁定。</div><div>     8. <span style="font-weight: bold;">用户账号</span><span style="font-weight: bold;">过期日期</span>（-E）：</div><div>        设置值为自1970-01-01起的天数，并按UTC时区计算。</div><div>        空字段表示它不会在特定的日期失效。</div><div>        <span style="color: rgb(255, 0, 0); font-weight: bold;">* 注意：并非教材上所说的密码过期日期！</span></div><div>     9. 最后一个字段通常为空，预留给将来使用。 </div><div><br/></div><ul><li><div><span style="font-weight: bold;">$ date -d &quot;1970-01-01 UTC &lt;</span><span style="font-style: italic; font-weight: bold;">number</span><span style="font-weight: bold;">&gt; day&quot;</span>：UTC时区1970年1月1日日期转换</div></li></ul><div><br/></div><div><span style="font-weight: bold;">加密密码格式：</span></div><ul><li><div><span style="font-weight: bold;">加密的密码包含三部分信息：哈希算法、salt、加密后的密码哈希。</span></div></li><li><div>每部分信息使用 $ 分隔。</div></li></ul><div>     <img src="chapter6_files/Image [30].png" type="image/png" data-filename="Image.png" width="496"/></div><div>     1. 哈希算法：<span style="font-weight: bold;">6表示SHA-512哈希算法，这是RHEL 8中的默认算法。</span></div><div>        1表示MD5哈希算法，5表示SHA-256哈希算法。</div><div>     2. salt：用于加密密码</div><div>     3. 用户密码的加密哈希值。</div><div>        salt和未加密密码组合并加密，⽣成加密的密码哈希。</div><div><br/></div><ul><li><div>salt可以防止两个密码相同的用户在/etc/shadow文件中拥有相同的条目。</div></li></ul><div><br/></div><div><span style="font-weight: bold;">密码验证：</span></div><ul><li><div>用户登录时，结合salt与用户输入的未加密密码，使用指定的哈希算法（SHA-512）</div></li></ul><div>     进行加密，生成的加密密码哈希与/etc/shadow中相应的用户条目（entry）进行比对。</div><div><br/></div><div><span style="font-weight: bold;">配置密码生命生命周期：</span></div><ul><li><div>密码生命周期示意图：</div></li></ul><div>     <img src="chapter6_files/Image [31].png" type="image/png" data-filename="Image.png" width="497"/></div><ul><li><div>chage命令用于修改密码生命周期</div></li></ul><div>     <img src="chapter6_files/Image [32].png" type="image/png" data-filename="Image.png" width="499"/></div><div><br/></div><ul><li><div><span style="font-weight: bold;">$ chage -m 0 -M 90 -W 7 -I 15 &lt;</span><span style="font-style: italic; font-weight: bold;">username</span><span style="font-weight: bold;">&gt;</span></div></li></ul><div>     # 注意：密码过期日期与用户账号过期日期不同！</div><div>     <img src="chapter6_files/Image [33].png" type="image/png" data-filename="Image.png" width="497"/>   </div><div><br/></div><ul><li><div>$ chage -d 0 &lt;<span style="font-style: italic;">username</span>&gt;：强制用户下次登录时更改密码</div></li></ul><div>     <img src="chapter6_files/Image [34].png" type="image/png" data-filename="Image.png" width="497"/></div><div><br/></div><ul><li><div>$ chage -l &lt;<span style="font-style: italic;">username</span>&gt;：查看用户密码生命周期详细信息</div></li><li><div>$ chage -E 2019-08-05 &lt;<span style="font-style: italic;">username</span>&gt;：设置用户账号的过期日期</div></li></ul><div><br/></div><div><span style="font-weight: bold;">限制访问：</span></div><ul><li><div>$ usermod -L &lt;<span style="font-style: italic;">username</span>&gt;：锁定用户账号</div></li></ul><div>     <img src="chapter6_files/Image [35].png" type="image/png" data-filename="Image.png" width="497"/></div><div>     <span style="color: rgb(0, 0, 255); font-weight: bold;">* 注意：</span>SSH客户端用户无法登录，可能该用户已被锁定！     </div><div><br/></div><ul><li><div>$ usermod -U &lt;<span style="font-style: italic;">username</span>&gt;：解锁用户账号</div></li><li><div><span style="font-weight: bold;">$ usermod -L -e 2019-01-05 &lt;</span><span style="font-style: italic; font-weight: bold;">username</span><span style="font-weight: bold;">&gt;</span>：锁定用户账号并设置用户账号过期时间</div></li></ul><div>     <img src="chapter6_files/Image [36].png" type="image/png" data-filename="Image.png" width="497"/></div><div><br/></div><div><span style="font-weight: bold;">nologin Shell：</span></div><ul><li><div>nologin shell用作不打算以交互⽅式登录系统的用户账户的替代shell。</div></li><li><div>从安全角度来看，如果用户账户担当的职责不需要用户登录系统，则禁止用户账户登录系统。</div></li></ul><div>     如系统服务账号，并不需要登录操作系统。</div><ul><li><div><span style="font-weight: bold;">这种情况的常用解决⽅案是将用户的登录shell设为/sbin/nologin。</span></div></li><li><div>如果用户试图直接登录系统，nologin shell将关闭该连接。</div></li></ul><div>     <img src="chapter6_files/Image [37].png" type="image/png" data-filename="Image.png" width="498"/></div><div><br/></div><div>     <span style="color: rgb(250, 122, 0); font-weight: bold;">练习 P195：</span><span style="color: rgb(250, 122, 0); font-weight: bold;">MANAGING USER PASSWORDS</span></div><div><span style="color: rgb(250, 122, 0); font-weight: bold;">     Lab P199：MANAGING LOCAL USERS AND GROUPS </span></div><div><br/></div></div><div><br/></div></span>
</div></body></html> 